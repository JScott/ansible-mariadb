---
- name: Import Signing Key | mariadb
  apt_key:
    state: present
    keyserver: 'hkp://keyserver.ubuntu.com:80'
    id: '0xcbcb082a1bb943db'

- name: Import Repository | mariadb/10.0
  apt_repository:
    state: present
    repo: 'deb http://mariadb.mirror.iweb.com/repo/10.0/ubuntu trusty main'
  notify: Update Package Cache

- name: Trigger All Callbacks
  meta: flush_handlers

- name: Preemptively Answer | MariaDB | Root Password
  shell: "debconf-set-selections << 'mariadb-server-10.0 mariadb-server/root_password password {{ database.password | mandatory }}'"
  shell: "debconf-set-selections << 'mariadb-server-10.0 mariadb-server/root_password_again password {{ database.password | mandatory }}'"
  when: mariadb_server

- name: Install Packages | apt
  apt:
    state: latest
    pkg: "{{ item }}"
  with_items:
    - mariadb-server
    - python-mysqldb
  when: mariadb_server

- name: Install Packages | apt
  apt:
    state: latest
    pkg: "{{ item }}"
  with_items:
    - mariadb-client
  when: mariadb_client
